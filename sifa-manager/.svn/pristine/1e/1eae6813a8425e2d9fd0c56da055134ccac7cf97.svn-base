<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ include file="/WEB-INF/views/include/taglib.jsp"%>
<script type="text/javascript">

$(function() {

//查询当月
$('#searchbtn1').click(function(){
	$('#searchStartDate').val(new Date())
	var lastMonthDate = new Date(); //上月日期  
	lastMonthDate.setDate(1);  
	lastMonthDate.setMonth(lastMonthDate.getMonth()-1);  
	$('#searchEndDate').val(lastMonthDate);
	$('#t_list_content').datagrid('load',
			 $.serializeObject($('#searchForm')));
});   

});

function formatOper(val,row,index){  
	var operation='<a href="javascript:void(0);" onclick="showPrint(\''+row.id+'\')">查看</a>'
		+'&nbsp;&nbsp;&nbsp;<a href="javascript:void(0);" onclick="submitTj(\''+row.id+'\')">上报</a>'
		+'&nbsp;&nbsp;&nbsp;<a href="javascript:void(0);" onclick="return(\''+row.id+'\')">退回</a>'
		+'&nbsp;&nbsp;&nbsp;<a href="javascript:void(0);" onclick="out(\''+row.id+'\')">导出</a>';

    return operation;
} 


function showPrint(id){
	//查看
	 parent.$.modalDialog({
         title : '统计详情',
         iconCls:'fi-plus icon-green',
         width : sy.getBrowerWidth()-250,
         height : sy.getBrowerHeight()-150,
         href : '${ctx}/statistics/culpritWorkTj/showPrint?id=' + id
     });
	
}

function submitTj(id){
	//上报
	 parent.$.modalDialog({
         title : '上报详情',
         iconCls:'fi-plus icon-green',
         width : sy.getBrowerWidth()-250,
         height : sy.getBrowerHeight()-150,
         href : '${ctx}/statistics/culpritWorkTj/submitTj?id=' + id
     });
	
}


function open_layer(title,url){
	
	var index = layer.open({
		type: 2,
		title: title,
		content: url
	});
	layer.full(index);
}

/* function addAskLeave(){
	 parent.$.modalDialog({
         title : '添加请假信息',
         iconCls:'fi-plus icon-green',
         width : sy.getBrowerWidth()-250,
         height : sy.getBrowerHeight()-150,
         href : '${ctx}/dailymgr/askLeave/form',
         buttons : [ {
             text : '保存',
             iconCls:'icon-save',
             handler : function() {
                 parent.$.modalDialog.openner_dataGrid = $('#t_list_content').datagrid();//因为添加成功之后，需要刷新这个dataGrid，所以先预定义好
                 var f = parent.$.modalDialog.handler.find('#culpritInfo');
                 f.submit();
             }
         },{
             text : '重置',
             iconCls:'icon-undo',
             handler : function() {
            	 var f = parent.$.modalDialog.handler.find('#culpritInfo');
            	 f.get(0).reset(); //清空表单数据 
             }
         }  ]
     });
} */

/* function deleteAskLeave(){
	var arr = $('#t_list_content').datagrid('getSelections');
	if (arr.length <= 0) {
		$.messager.show({
			title : '提示信息!',
			msg : '至少选择一行记录进行删除!'
		});
	} else {

		$.messager.confirm('提示信息', '确认删除?', function(r) {
			if (r) {
				var ids = '';
				for (var i = 0; i < arr.length; i++) {
					if (i == 0) {
						ids += "ids=" + arr[i].id
					} else {
						ids += "&ids=" + arr[i].id;
					}

				}
				//ids = ids.substring(0, ids.length - 1);
				$.post('${ctx}/dailymgr/askLeave/batchDelete', {
					ids : ids
				}, function(result) {
					//1 刷新数据表格 
					$('#t_list_content').datagrid('reload');
					//2 清空idField   
					$('#t_list_content').datagrid('uncheckAll');
					//3 给提示信息 
					$.messager.show({
						title : '提示信息!',
						msg : '操作成功!'
					});
				});
			} else {
				return;
			}
		});
	}
} */
</script>

<div class="easyui-layout" data-options="fit:true,border:false">
	<div data-options="region:'east',border:true,split:false,title:'搜索'" style="width: 250px;">
        <div class="easyui-layout" data-options="fit:true,border:false">
        <div region="center" border="false">
        <form id="searchWorkTjForm"  style="padding-bottom: 10px;padding-top: 10px;">
			<table>
				<tr>
					<td width="35%" align="right">所属部门：</td>
					<td>
						<select id="sysGroupId" name="groupId" class="easyui-combotree" style="width: 150px;"
    					data-options="url:'${ctx}/sys/sysGroup/loadGroupTree',editable:true">
						</select>
					</td>
				</tr>
				<tr>
				<td width="35%" align="right">统计年度：</td>
					<td><input  name=year class="Wdate easyui-validatebox" onclick="WdatePicker({readOnly:true,dateFmt:'yyyy'})" editable="false" style="width: 150px;" /></td>
				</tr>
				<tr style="border:1px;">
				<td width="35%" align="right" rowspan="4">季度：</td>
					<td><input type="radio" value="1" name="jd"/>一季度&nbsp;&nbsp;</br>
					<input type="radio" value="2" name="jd"/>二季度&nbsp;&nbsp;</br>
					<input type="radio" value="3" name="jd"/>三季度&nbsp;&nbsp;</br>
					<input type="radio" value="4" name="jd"/>四季度&nbsp;&nbsp;</td>
				</tr>
				<tr>
			</table>
		</form>
		</div>
		 <div data-options="region:'south',border:false" style="height: 30px;line-height:30px; overflow: hidden;text-align: center;background-color: #eee" ><a
						href="#" class="easyui-linkbutton" iconCls="icon-search" onclick="javascript:$('#t_culprit_work_content').datagrid('load' ,$.serializeObject($('#searchWorkTjForm')));"
						id="searchWorkTjBtn">搜索</a> &nbsp;&nbsp; 
						<a href="#" class="easyui-linkbutton" id="cleanTjBtn" iconCls="icon-undo" onclick="javascript:$('#searchWorkTjForm').form('clear');">清空</a></div>
		</div>
	</div>
    <div data-options="region:'center',border:true" >
        <table class="easyui-datagrid" id="t_culprit_work_content" title="社区矫正统计报表（季表）"
			data-options="singleSelect:true,fit:true,toolbar:'#toolbar',collapsible:true,striped:true,loadMsg: '数据正在加载,请耐心的等待...' ,pagination:true,pageSize: 10 ,pageList:[5,10,15,20,50],fitColumns:true,url:'${ctx}/statistics/culpritWorkTj/list',method:'post'">
			<thead>
				<tr>
					<th data-options="field:'id',checkbox:true,width:80">编号</th>
					<th data-options="field:'groupName',width:100,align:'center'"
						editor="{type:'validatebox',options:{required:true}}">单位</th>
					<th data-options="field:'year',width:120,align:'center',sortable:true,"
						editor="text">统计年度</th>
					<th data-options="field:'jd',width:120,align:'center',sortable:true"
						editor="text">统计季度</th>
					<th data-options="field:'dicState',width:120,align:'center',sortable:true,
					formatter:function(value,rowData,rowIndex){return sy.getDicValue('sf_culprit_tj','dic_state',value,'')}"
						editor="text">报表状态</th>
				 	<th data-options="field:'_opt',width:200,formatter:formatOper,align:'center'">操作</th>  

				</tr>
			</thead>
		</table>
    </div>
</div>
<!-- <div id="toolbar" style="display: none;">
   <div id="toolbar"> 
		<a id="searchbtn1" href="javascript:void(0);" class="easyui-linkbutton" data-options="plain:true,iconCls:'icon-search'">查看当月</a>  
	</div>
</div> -->
