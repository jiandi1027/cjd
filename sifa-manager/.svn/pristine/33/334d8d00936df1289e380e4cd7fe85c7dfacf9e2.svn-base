<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ include file="/WEB-INF/views/include/taglib.jsp"%>

 <form action="${ctx}/monitoring/overAlarm/save" method="post" id="overAlarmHisformAdd" name="overAlarmHisformAdd">
     <div class="easyui-panel" style="width: 100%; padding: 5px;margin:0 auto;">
     	<input type="hidden" name="id" id="id" value="${overAlarm.id }"/>
        <table width="100%" class= "grid">
            <tr>
                <th width="20%" >姓名：</th>
                <td width="80%">${overAlarm.culpritName }</td>
            </tr>
            <tr>
				<th>越界时间：</th>
				<td><fmt:formatDate value='${overAlarm.gpsTime }' pattern="yyyy-MM-dd HH:mm:ss" /></td>
				</tr>
           	<tr>
           		<th>越界位置：</th>
           		<td>${overAlarm.location }</td>
           	</tr>
			<tr>
				<th>扣分：</th>
				<td>
					<select name="delmark" class="easyui-combobox" data-options="editable:false,panelMaxHeight:'200',panelHeight:'auto',width:'173'">
						<option value="0">不扣分</option>
						<option value="-2">按未请假扣分</option>
						<option value="-1">按未销假扣分</option>
					</select>
				</td>
			</tr>
			<tr>
				<th><span class="c-red">*</span>处理方案2：</th>
				<td>
					<input name="note" class="easyui-combobox" data-options="valueField:'key',textField:'value',editable:false, 
					url:'${ctx}/sys/sysDic/getDicValueByParent?tabName=common_table&columnName=note&parentKey=94000',panelMaxHeight:'200',panelHeight:'auto'" 
					required=true missingMessage="处理方案不能为空!" >
				</td>
			</tr>
        </table>           
    </div>
</form>
<script>
$(function() {
	$('#overAlarmHisformAdd').form({
		url:'${ctx}/monitoring/overAlarm/save',
		async : false,
   		onSubmit:function(){
   			progressLoad();
   			var isValid = $(this).form('validate');
            if (!isValid) {
            	$.messager.show({
   					title:'提示信息!' ,
   					msg:'处理方案不能为空!'
   				});
            	
            	progressClose();
            	return isValid;
            }
            
            return isValid;
   		},
   		success:function(data){
        	progressClose();
   			data = JSON.parse(data);
   			if(data.status==200){
   				$.messager.show({
   					title:'提示信息!' ,
   					msg:data.msg
   				});
   				
	        	$('#overAlarm_list').datagrid('reload');
	        	$('#overAlarm_his_list').datagrid('reload');
                $('#overAlarmHisDealForm').dialog('close');
   			}else{
   				parent.$.messager.alert('错误', result.msg, 'error');
   			}
   		}
   	});	
     
});
</script>