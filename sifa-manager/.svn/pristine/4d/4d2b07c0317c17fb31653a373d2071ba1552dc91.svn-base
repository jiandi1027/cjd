package com.rowell.sifa.service.statistics;

import java.util.Calendar;
import java.util.Date;
import java.util.List;
import java.util.Timer;
import java.util.TimerTask;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.rowell.sifa.mapper.statistics.CulpritWorkTjMapper;
import com.rowell.sifa.pojo.statistics.CulpritWorkTj;
import com.rowell.sifa.pojo.statistics.CulpritWorkTj;
import com.rowell.sifa.pojo.sys.SysAccount;
import com.rowell.sifa.pojo.sys.SysGroup;
import com.rowell.sifa.service.base.CrudService;
import com.rowell.sifa.service.sys.SysGroupService;
/**
 * 
    * @ClassName: CulpritWorkTjService  
    * @Description:  社区矫正统计报表（季表）
    * @author DELL  
    * @date 2017年4月13日  
    *
 */
@Service
@Transactional(readOnly = true)
public class CulpritWorkTjService extends CrudService<CulpritWorkTjMapper,CulpritWorkTj>  {
	@Autowired
	private SysGroupService sysGroupService;
	@Autowired
	private CulpritWorkTjMapper culpritWorkTjMapper;
	public void timerInsert(){
		Calendar c = Calendar.getInstance();
		int month = c.get(Calendar.MONTH) + 1;
		if(month>=1&&month<=3){//当前月份是1月，则为4季度
			c.set(Calendar.MONTH, 3);
		}else if(month>=4&&month<=6){
			c.set(Calendar.MONTH, 0);
		}else if(month>=7&&month<=9){
			c.set(Calendar.MONTH, 1);
		}else if(month>=10&&month<=12){
			c.set(Calendar.MONTH, 2);
		}
        Date reportDate =c.getTime();
		List<SysGroup>list=sysGroupService.findAll(new SysGroup());
		CulpritWorkTj culpritWorkTj=new CulpritWorkTj();
		for(SysGroup sysGroup:list){
			String groupId=sysGroup.getId();
			culpritWorkTj.setGroupId(groupId);
			culpritWorkTj.setDicState("91802");//未上报
			culpritWorkTj.setCurrentSysUser(new SysAccount());
			//统计年月
			culpritWorkTj.setReportDate(reportDate);
			//统计年份
			culpritWorkTj.setYear(c.get(Calendar.YEAR)+"");
			culpritWorkTj.setJd((c.get(Calendar.MONTH))+1+"");
			
			
			
			this.insert(culpritWorkTj);//自动插入CulpritWorkTj对象
		}
	}

}









