<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ include file="/WEB-INF/views/include/taglib.jsp"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- 引用jquery easy ui的js库及css -->
<%@include file="/WEB-INF/views/include/head.jsp"%>
<link rel="stylesheet" type="text/css" href="${ctxStatic}/css/style.css" />
<title>审核</title>
</head>
<body>

	<form id="askLeaveAuditForm" name="askLeaveAuditForm"
		action="${ctx}/rewardspunishment/reducePenalty/submitCommendAudit"
		method="post">
		<input type="hidden" name="taskId" value="${reducePenalty.taskId}" />
		<input type="hidden" name="id" value="${reducePenalty.id}" /> <input
			type="hidden" name="auditType" value="${reducePenalty.auditType}" />
	 	<c:choose>
 		<c:when test="${empty reducePenalty.culpritId }">
 		
 			<sys:culpritInfo hiddenId="culpritId" hiddenName="culpritId" id="culpritName" name="culpritName" required="true" hiddenValue="" formId="culpritInfo" isSelect="true"/>
 		</c:when>
 		<c:otherwise>
 	
 			<sys:culpritInfo hiddenId="culpritId" hiddenName="culpritId" id="culpritName" name="culpritName" required="false" hiddenValue="${reducePenalty.culpritId}" formId="culpritInfo" isSelect="false"/>
 		</c:otherwise>
 	</c:choose>
		<div class="easyui-panel" id="p2" title="减刑信息"
			style="width: 100%; padding: 10px;">
			<table width="100%" class="grid">
				<tr>
					<th width="9%">证据材料:</th>
					<td width="23%">无附件</td>
					<th width="9%">结案报告:</th>
					<td width="23%">无附件</td>
					<th width="9%">法律依据:</th>
					<td width="23%">无附件</td>

				</tr>
				<tr>
					<th>表现情况:</th>
					<td><input class="easyui-textbox"  readonly="true"
						data-options="multiline:true" value=${reducePenalty.actions }
						style="width: 300px"></td>
				</tr>
				<c:if test="${commend.auditType ne 'workerReport' }">
					<TR>

						<th>审核结果：</th>
						<TD><input type="radio" name="decideType" value="1"
							checked="checked" />同意 
							<c:if test="${sysAccount == 1007 }">
							<input type="radio" name="decideType" value="1"
							checked="checked" />打印
							</c:if>
							<c:if test="${sysAccount != 3003 }">
							<input type="radio" name="decideType"
							value="2" />退回
							</c:if>
					</TR>
					<tr>
						<th>审核意见</th>
						<TD>
						<textArea class="f1 easyui-validatebox"   style="width:685px;height:130px;"
					data-options="multiline:true" name="opinion" required=true id="opinion"
					style="width: 280px; height: 100px" onkeydown='textarealength(this,300)' onKeyUp="textarealength(this,300)" maxlength="300"></textArea>
					<br>
						备注：此处最多可以输入<em class="c-red">300</em>个字，你已输入<em class="textarea-length c-red">0</em>个字。
						</TD>

					</tr>
				</c:if>
			</table>
		</div>


		</TBODY>
		</TABLE>
		<c:if test="${commend.auditType eq 'workerReport' }">
			<input type="hidden" name="decideType" value="1" />
		</c:if>

	</form>
	<script type="text/javascript">
	  $(function() {
	      	$('#askLeaveAuditForm').form({
	      		url:'${ctx}/rewardspunishment/reducePenalty/submitCommendAudit',
	      		onSubmit:function(){
	      			 progressLoad();
	      			 var isValid = $(this).form('validate');
	                   if (!isValid) {
	                       progressClose();
	                   }
	                   return isValid;
	      		},
	      		success:function(data){
	      			data = JSON.parse(data);
	      			progressClose();
	      			if(data.status==200){
	      				$.messager.show({
	      					title:'提示信息!' ,
	      					msg:data.msg
	      				});
	      				
	      				 parent.$.modalDialog.openner_dataGrid.datagrid('reload');//之所以能在这里调用到parent.$.modalDialog.openner_dataGrid这个对象，是因为user.jsp页面预定义好了
	                       parent.$.modalDialog.handler.dialog('close');
	  					
	      			}else{
	      				 parent.$.messager.alert('错误', result.msg, 'error');
	      			}
	      			
	      		}
	      	});
	      });

	</script>
</body>
</html>