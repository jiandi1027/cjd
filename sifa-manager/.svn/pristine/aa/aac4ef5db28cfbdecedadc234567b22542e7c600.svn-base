<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ include file="/WEB-INF/views/include/taglib.jsp"%>
<form  action="#" method="post" id="deathDeatilFrom">
 <input type="hidden" name="id" id="id" value="${death.id}"/>
 	<c:choose>
 		<c:when test="${empty death.culpritId }">
 		
 			<sys:culpritInfo hiddenId="culpritId" hiddenName="culpritId" id="culpritName" name="culpritName" required="true" hiddenValue="" formId="deathDeatilFrom" isSelect="true"/>
 		</c:when>
 		<c:otherwise>
 	
 			<sys:culpritInfo hiddenId="culpritId" hiddenName="culpritId" id="culpritName" name="culpritName" required="false" hiddenValue="${death.culpritId}" formId="deathDeatilFrom" isSelect="false"/>
 		</c:otherwise>
 	</c:choose>
 	 <div class="easyui-panel" title="死亡登记信息" style="width:98%;padding:5px;">
            <table width="100%" class="grid">
                <tr>
                   <th width="10%">死亡日期：</th>
							<td width="90%"><fmt:formatDate value='${death.deathlTime}' pattern="yyyy-MM-dd HH:mm:ss" /></td>
                </tr>
                <tr>
                    <th>死亡原因：</th>
							<td ><input readonly = 'readonly'type="text" name="deathReason" value="${death.deathReason }"  
								class="f1 easyui-textbox" multiline="true" style = "width:50%"/></td>
                </tr>
                  <tr>
                    <th>其他情况：</th>
							<td ><input readonly = 'readonly' type="text" name="situation" value="${death.situation }"  
								class="f1 easyui-textbox" multiline="true" style = "width:50%"/></td>
                </tr>
                 <tr>
                    <th>死亡通知书：</th>
							<td ><input readonly = 'readonly' type="text" name="situation" value="${death.pathName }"  
								class="f1 easyui-textbox" multiline="true" style = "width:50%"/></td>
                </tr>
            </table>
    </div>
	<div class="easyui-panel" title="流程信息" style="width: 100%; padding: 5px; margin-bottom: 10px;">
		<table width="100%" class="grid" style="text-align: center;">
			<tr>
				<th style="text-align: center;" >操作人</th>
				<th style="text-align: center;" >操作时间</th>
				<th style="text-align: center;" >操作环节</th>
				<th style="text-align: center;" >意见</th>
			</tr>
			<c:forEach items="${processDetails}" var="processDetail">
				<tr>
					<td>${processDetail.createrCnName }</td>
					<td><fmt:formatDate value="${processDetail.created }"
							pattern="yyyy-MM-dd HH:mm:ss" /></td>
					<td>${processDetail.auditName }</td>
					<c:if test="${processDetail.dicDecideType==1 }" >
						<td>同意</td>
					</c:if>
					<c:if test="${processDetail.dicDecideType==2 }" >
						<td>退回</td>
					</c:if>
					<c:if test="${processDetail.dicDecideType==0 }" >
						<td>不同意</td>
					</c:if>


				</tr>
			</c:forEach>

		</table>
	</div>
	   </form>
		<script>
		  $(function() {
     $('#culpritId').combogrid({    
        	delay: 500,
        	 panelWidth: 300, 
        	 striped:true,
        	 panelHeight: 300,
    		mode: 'remote',  
			idField: 'id',
			textField: 'name',
			url: '${ctx}/culpritinfo/culprit/list',
			columns: [[
				{field:'name',title:'姓名',width:120,align:'center'},
				{field:'dicSexKey',title:'性别',width:80,align:'center'}
			]],
			fitColumns: true,
			pagination: true,           //是否分页  
        rownumbers: true,           //序号  
        collapsible: false,         //是否可折叠的  
        method: 'post',
        onSelect:function(record){
        	 var arr = $('#culpritId').combogrid('grid').datagrid('getSelections');
        	 $('#deathDeatilFrom').form('load',arr[0]);
       	}
        }); 
        
        
      //取得分页组件对象  
        var pager = $('#culpritId').combogrid('grid').datagrid('getPager');  
        if (pager) {  
            $(pager).pagination({  
                pageSize: 10,               //每页显示的记录条数，默认为10  
                beforePageText: '第',       //页数文本框前显示的汉字  
                afterPageText: '',
                displayMsg: ''
            }) 
        }  
        });
        </script>
